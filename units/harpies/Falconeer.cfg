#textdomain wesnoth-Harpies
[unit_type]
    id=Harpy Falconeer
    name= _ "Harpy Falconeer"
    race=harpy
    image="units/harpies/falconeer/harpy-falconeer.png"
    image_icon="units/harpies/falconeer/harpy-falconeer.png"
    profile="units/harpies/falconeer/harpy-falconeer.png"
    hitpoints=32
    movement_type=harpyfly
    movement=7
    experience=38
    gender=female
    level=1
    alignment=lawful
    advances_to=Harpy Raptortongue, Harpy Flagbearer
    cost=18
    usage=mixed fighter

    description= _ "Various birds are popular among harpies as pets. Among them, falcons are used for hunting, and warfare when the need arises. Some harpies can easily mimic their calls, granting the bird and its wielder excellent coordination. "

    [defense]
        hills=40
        mountains=30
    [/defense]
    die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
    [death]
        start_time=0
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-death[1~9].png:[100,50*8]"
        [/frame]
    [/death]

    {DEFENSE_ANIM "units/harpies/falconeer/harpy-falconeer-hit[1~3].png:75" "units/harpies/falconeer/harpy-falconeer.png" {SOUND_LIST:HUMAN_FEMALE_HIT} }

    [standing_anim]
        [frame]
            image="units/harpies/falconeer/harpy-falconeer.png"
        [/frame]
    [/standing_anim]
    [standing_anim]
        start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-flyb[1~4].png:150"
        [/frame]
    [/standing_anim]
    [movement_anim]
        start_time=0
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-flyb[1~4].png:150"
        [/frame]
    [/movement_anim]
    [pre_movement_anim]
    start_time=0
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [post_movement_anim]
    start_time=0
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [draw_weapon_anim]
    start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [sheath_weapon_anim]
    start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [idle_anim]
        {STANDARD_IDLE_FILTER}
        start_time=0
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-idling[1~15].png:[100*10,200,100,150,100*2]"
        [/frame]
    [/idle_anim]


    [attack]
        name=claws
        description=_"talons"
        type=blade
        range=melee
        damage=8
        number=2
        icon=attacks/claws-animal.png
    [/attack]

    [attack]
        name=falcon
        description=_"falcon"
        type=blade
        range=ranged
        damage=5
        number=3
        icon=attacks/claws-animal.png
    [/attack]

    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-talonb[1~7].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
        start_time=-500
        [frame]
            image="units/harpies/falconeer/harpy-falconeer-falconhunt[1~8].png:[100*4,100,100*3]"
        [/frame]
        missile_start_time=-200 
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[150,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_y=0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_y=0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/falconeer/harpy-falconeer.png:50"
        [/frame]
    [/attack_anim]
[/unit_type]

[unit_type]
    id=Harpy Raptortongue
    name= _ "Harpy Raptortongue"
    race=harpy
    image="units/harpies/raptortongue/harpy-raptortongue-healthy.png"
    image_icon="units/harpies/raptortongue/harpy-raptortongue-healthy.png"
    profile="units/harpies/raptortongue/harpy-raptortongue-healthy.png"
    hitpoints=46
    movement_type=harpyfly
    movement=7
    experience=80
    gender=female
    level=2
    alignment=lawful
    advances_to=Harpy Flockmaster
    cost=33
    usage=mixed fighter

    description= _ "Over time falconeers efficiently learn the falcons' language. As the bird ages their tamer often will bring in new recruits for taming. "

#all anims are filtered based on the unit's health level, to reflect the falcon flock whittling down with swarm. So there's 2 variations for each anim (except death)

    [defense]
        hills=40
        mountains=30
    [/defense]

    [attack]
        name=claws
        description=_"talons"
        type=blade
        range=melee
        damage=7
        number=3
        icon=attacks/claws-animal.png
    [/attack]

    [attack]
        name=falcon
        description=_"falcon storm"
        type=blade
        range=ranged
        [specials]
            {WEAPON_SPECIAL_SWARM}
        [/specials]
        damage=5
        number=7
        icon=attacks/claws-animal.png
    [/attack]

    die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
    [death]
        start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-death[1~9].png:[100,50*8]"
        [/frame]
    [/death]

    {DEFENSE_ANIM_FILTERED "raptortongue/harpy-raptortongue-healthy-hit[1~3].png:75" "units/harpies/raptortongue/harpy-raptortongue-healthy.png" {SOUND_LIST:HUMAN_FEMALE_HIT} 
(   [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
)}
    {DEFENSE_ANIM_FILTERED "raptortongue/harpy-raptortongue-wounded-hit[1~3].png:75" "units/harpies/raptortongue/harpy-raptortongue-wounded.png" {SOUND_LIST:HUMAN_FEMALE_HIT} 
(   [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
)}

    [movement_anim]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-fly[1~4].png:150"
        [/frame]
    [/movement_anim]
    [movement_anim]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-fly[1~4].png:150"
        [/frame]
    [/movement_anim]


    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]


    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]


    [draw_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [draw_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]


    [sheath_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [sheath_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]


    [standing_anim]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy.png"
        [/frame]
    [/standing_anim]
    [standing_anim]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded.png"
        [/frame]
    [/standing_anim]

    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-fly[1~4].png:150"
        [/frame]
    [/standing_anim]
    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-fly[1~4].png:150"
        [/frame]
    [/standing_anim]


    [idle_anim]
        {STANDARD_IDLE_FILTER}
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-idling[1~23].png:100"
        [/frame]
    [/idle_anim]


    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
    [/filter]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-talon[1~8].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
    [/filter]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-talon[1~7].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]


#falcon storm anim breakdown : a)flockmaster sends away the falcons who leave one by one following the one on her wing b)flockmaster waits for the falcons to return c)the falcons return to the flockmaster one by one in the order they left. So for a) we use the frames specific to helath level, and it's -1 frame for each dead falcon. The missing frame(s) is recovered in b) using an additional frame from the "dying" version of the hunt anim. c) simply makes the anim end 1 frame earlier for each dying falcon

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
    [/filter]
        start_time=-500
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy-hunt[1~9].png:[100*6,75,50*2]"
        [/frame]
        missile_start_time=-200
        missile2_start_time=-125    
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]   
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]   
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-healthy.png:50"
        [/frame]
    [/attack_anim]


    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
    [/filter]
        start_time=-500
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded-hunt[1~4].png:100,units/harpies/raptortongue/harpy-raptortongue-healthy-hunt[5~7].png:[100*2,75],units/harpies/raptortongue/harpy-raptortongue-wounded-hunt8.png:50"
        [/frame]
        missile_start_time=-200 
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]    
    [/else]
        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/raptortongue/harpy-raptortongue-wounded.png:50"
        [/frame]
    [/attack_anim]

[/unit_type]

[unit_type]
    id=Harpy Flockmaster
    name= _ "Harpy Flockmaster"
    race=harpy
    image="units/harpies/flockmaster/dying/harpy-flockmaster.png"
    image_icon="units/harpies/flockmaster/dying/harpy-flockmaster.png"
    profile="units/harpies/flockmaster/dying/harpy-flockmaster.png"
    hitpoints=58
    movement_type=harpyfly
    movement=7
    experience=150
    gender=female
    level=3
    alignment=lawful
    advances_to=null
    {AMLA_FLOCKMASTER}
    cost=60
    usage=archer

    description= _ "Harpies whose love for birds is extreme spend their life with them, flying and hunting together. With their skilled calls they bring together small flocks of hawks to help them, directing them to reach their goal more efficiently. "

#all anims are filtered based on the unit's health level, to reflect the falcon flock whittling down with swarm. So there's 4 variations for each anim (except death)
#for the filters using two conditions (for scratched and wounded) be careful to place each formula in and /and tags

    [defense]
        flat=40
        hills=40
        mountains=30
        forest=-50
    [/defense]

    [attack]
        name=claws
        description=_"talons"
        type=blade
        range=melee
        damage=9
        number=3
        icon=attacks/claws-animal.png
    [/attack]

    [attack]
        name=falcon
        description=_"falcon storm"
        type=blade
        range=ranged
        [specials]
            {WEAPON_SPECIAL_SWARM}
        [/specials]
        damage=5
        number=11
        icon=attacks/claws-animal.png
    [/attack]

    die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
    [death]
        start_time=0
        [frame]
            image="units/harpies/flockmaster/harpy-flockmaster-death[1~11].png:[100,50*10]"
        [/frame]
    [/death]

    {DEFENSE_ANIM_FILTERED "units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-hit[1~4].png:75" "units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-idle1.png" {SOUND_LIST:HUMAN_FEMALE_HIT} 
(   [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
)}
    {DEFENSE_ANIM_FILTERED "units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-hit[1~4].png:75" "units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-idle1.png" {SOUND_LIST:HUMAN_FEMALE_HIT} 
(   [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
)}
    {DEFENSE_ANIM_FILTERED "units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-hit[1~4].png:75" "units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-idle1.png" {SOUND_LIST:HUMAN_FEMALE_HIT} 
(   [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
)}
    {DEFENSE_ANIM_FILTERED "units/harpies/flockmaster/dying/harpy-flockmaster-hit[2~4].png:75" "units/harpies/flockmaster/dying/harpy-flockmaster.png" {SOUND_LIST:HUMAN_FEMALE_HIT} 
(   [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
)}

    [movement_anim]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-fly[1~4].png:150"
        [/frame]
    [/movement_anim]
    [movement_anim]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-fly[1~4].png:150"
        [/frame]
    [/movement_anim]
    [movement_anim]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-fly[1~4].png:150"
        [/frame]
    [/movement_anim]
    [movement_anim]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
        start_time=0
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-fly[1~4].png:150"
        [/frame]
    [/movement_anim]


    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]


    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]


    [draw_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [draw_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [draw_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [draw_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]


    [sheath_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [sheath_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [sheath_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [sheath_weapon_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
    start_time=0
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]


    [standing_anim]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-idle[1~12].png:100"
        [/frame]
    [/standing_anim]
    [standing_anim]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
    [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-idle[1~12].png:100"
        [/frame]
    [/standing_anim]
    [standing_anim]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
    [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-idle[1~12].png:100"
        [/frame]
    [/standing_anim]
    [standing_anim]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster.png:100"
        [/frame]
    [/standing_anim]

    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-fly[1~4].png:150"
        [/frame]
    [/standing_anim]
    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
    [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-fly[1~4].png:150"
        [/frame]
    [/standing_anim]
    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
    [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-fly[1~4].png:150"
        [/frame]
    [/standing_anim]
    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
        [/filter]
    [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-fly[1~4].png:150"
        [/frame]
    [/standing_anim]


    [idle_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
        [/filter]
        {STANDARD_IDLE_FILTER}
        start_time=0
        [frame]
            image="units/harpies/flockmaster/harpy-flockmaster-idling[1~20].png:100"
        [/frame]
    [/idle_anim]



    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
    [/filter]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-talon[1~7].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-talon[1~7].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
    [/filter]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-talon[1~7].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]
    [attack_anim]
        [filter_attack]
            name=claws
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
    [/filter]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-dying-talon[1~7].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS {SOUND_LIST:SWORD_SWISH} {SOUND_LIST:MISS} -25}
    [/attack_anim]


#falcon storm anim breakdown : a)flockmaster sends away the falcons who leave one by one following the one on her wing b)flockmaster waits for the falcons to return c)the falcons return to the flockmaster one by one in the order they left. So for a) we use the frames specific to helath level, and it's -1 frame for each dead falcon. The missing frame(s) is recovered in b) using an additional frame from the "dying" version of the hunt anim. c) simply makes the anim end 1 frame earlier for each dying falcon

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints >= self.max_hitpoints / 4*3, 1, 0)"
    [/filter]
        start_time=-500
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-hunt[1~6].png:[100*3,75*3],units/harpies/flockmaster/dying/harpy-flockmaster-hunt[6~8].png:50,units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-hunt[9~10].png:75"
        [/frame]
        missile_start_time=-200
        missile2_start_time=-125
        missile3_start_time=-50
        missile4_start_time=25  
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[4,5].png:[100,50],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]
        [missile3_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile3_frame]
        [missile4_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=-20~0,0~-20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile4_frame]   
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[1,2,3].png:[50*3],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon4.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]
        [missile3_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile3_frame]
        [missile4_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=-20~0,0~-20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile4_frame]   
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-idle[1~3].png:50"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 4*3, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 2, 1, 0)"
        [/and]
        [/filter]
        start_time=-500
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-hunt[1~5].png:[100*3,75*2],units/harpies/flockmaster/dying/harpy-flockmaster-hunt[6~8].png:[125,50*2],units/harpies/flockmaster/healthy/harpy-flockmaster-healthy-hunt9.png:75"
        [/frame]
        missile_start_time=-200
        missile2_start_time=-125
        missile3_start_time=-50 
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[4,5].png:[100,50],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]
        [missile3_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile3_frame]   
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[1,2,3].png:[50*3],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon4.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]
        [missile3_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile3_frame]   
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/flockmaster/scratched/harpy-flockmaster-scratched-idle[1~3].png:50"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
    [filter]
        [and]
            formula="if(self.hitpoints < self.max_hitpoints / 2, 1, 0)"
        [/and]
        [and]
            formula="if(self.hitpoints >= self.max_hitpoints / 4, 1, 0)"
        [/and]
        [/filter]
        start_time=-500
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-hunt[1~4].png:[100*3,75],units/harpies/flockmaster/dying/harpy-flockmaster-hunt[5~8].png:[75,125,50*2]"
        [/frame]
        missile_start_time=-200
        missile2_start_time=-125
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[4,5].png:[100,50],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[100,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]   
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[1,2,3].png:[50*3],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon4.png~FL(horiz):150"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0,0~20
        halo_y=-20~0,0~-20
        auto_vflip=no
            [/missile_frame]
        [missile2_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_y=-40~0,0~-40
        auto_vflip=no
            [/missile2_frame]   
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/flockmaster/wounded/harpy-flockmaster-wounded-idle[1~3].png:50"
        [/frame]
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
    [filter]
            formula="if(self.hitpoints < self.max_hitpoints / 4, 1, 0)"
    [/filter]
        start_time=-500
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster-hunt[1~8].png:100"
        [/frame]
        missile_start_time=-200 
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[4,5].png:[150,50],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon1.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[1,2,3].png:[100,50*2],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]    
    [/else]
        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/flockmaster/dying/harpy-flockmaster.png:50"
        [/frame]
    [/attack_anim]

[/unit_type]

[unit_type]
    id=Harpy Flagbearer
    name= _ "Harpy Flagbearer"
    race=harpy
    image="units/harpies/flagbearer/harpy-flagbearer-idleb1.png~CROP(0,0,72,72)"
    image_icon="units/harpies/flagbearer/harpy-flagbearer-idleb1.png~CROP(0,0,72,72)"
    profile="units/harpies/flagbearer/harpy-flagbearer-idleb1.png~CROP(0,0,72,72)"
    hitpoints=48
    movement_type=harpyfly
    movement=7
    experience=75
    gender=female
    level=2
    alignment=lawful
    advances_to=Harpy Featherlord
    cost=35
    usage=mixed fighter

    description= _ "The habit of guiding their bird around gives harpies skills in observing and giving out orders, which are applicable in wide scale combat as well. Some falconeers take up the flag-bearing spear to lead their peers in battle, and while their fighting strength is lesser than others', the coordination they bring to the squadron makes it much more deadly. "

    [abilities]
        {ABILITY_RALLY}
        {ABILITY_STEADFAST_CC}
    [/abilities]
    [defense]
        hills=40
        mountains=30
    [/defense]
    [resistance]
        blade=95
        pierce=95
    [/resistance]

    [leading_anim]
        start_time=-200
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-lead[1~4].png:75,units/harpies/flagbearer/harpy-flagbearer-idleb1.png:50"
        [/frame]
        halo_start_time=-100
        [halo_frame]
            halo="halo/misc/leadership-flare-[1~13].png:20"
            halo_x,halo_y=40,-36
        [/halo_frame]
    [/leading_anim]

    [standing_anim]
        start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-idleb[1~4].png:200"
        [/frame]
    [/standing_anim]
    [standing_anim]
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-fly[1~4].png:150"
        [/frame]
    [/standing_anim]
    die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
    [death]
        start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-death[1~10].png:[100,50*9]"
        [/frame]
    [/death]

    {DEFENSE_ANIM "units/harpies/flagbearer/harpy-flagbearer-hit[1~3].png:75" "units/harpies/flagbearer/harpy-flagbearer-idleb1.png" {SOUND_LIST:HUMAN_FEMALE_HIT} }

    [movement_anim]
        start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-fly[1~4].png:150"
        [/frame]
    [/movement_anim]
    [pre_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [post_movement_anim]
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
    start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [draw_weapon_anim]
    start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [sheath_weapon_anim]
    start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [idle_anim]
        {STANDARD_IDLE_FILTER}
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        start_time=0
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-hunt[1~3].png:100,units/harpies/flagbearer/harpy-flagbearer-idling[1~13].png:100,units/harpies/flagbearer/harpy-flagbearer-hunt[9~10].png:100"
        [/frame]
    [/idle_anim]


    [attack]
        name=lance
        description=_"lance"
        type=pierce
        range=melee
        damage=13
        number=2
        icon=attacks/pike.png
    [/attack]

    [attack]
        name=falcon
        description=_"falcon"
        type=blade
        range=ranged
        damage=6
        number=3
        icon=attacks/claws-animal.png
    [/attack]

    [attack_anim]
        [filter_attack]
            name=lance
        [/filter_attack]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-spear[1~5].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS spear.ogg {SOUND_LIST:MISS} -25}
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
        start_time=-500
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-hunt[1~10].png:[100*4,50*4,100*2]"
        [/frame]
        missile_start_time=-200 
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[4,5].png:[150,50],units/harpies/falconeer/harpy-falconeer-falconlunge1.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/falconeer/harpy-falconeer-falconlunge[1,2,3].png:[100,50*2],units/harpies/falconeer/harpy-falconeer-falconlunge4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/flagbearer/harpy-flagbearer-idleb1.png:50"
        [/frame]
    [/attack_anim]
[/unit_type]

[unit_type]
    id=Harpy Featherlord
    name= _ "Harpy Featherlord"
    race=harpy
    image="units/harpies/featherlord/harpy-featherlord.png"
    image_icon="units/harpies/featherlord/harpy-featherlord.png"
    profile="units/harpies/featherlord/harpy-featherlord.png"
    hitpoints=62
    movement_type=harpyfly
    movement=7
    experience=100
    gender=female
    level=3
    alignment=lawful
    advances_to=null
    {AMLA_FEATHERLORD}
    cost=65
    usage=mixed fighter

    description= _ "Harpy commanders use their bird companion and specific calls to quickly transmit orders on the battlefield. Their brightly colored flag helps them catch their allies' attention to redirect troops wherever necessary. "

    [abilities]
        {ABILITY_RALLY}
        {ABILITY_STEADFAST_CC}
    [/abilities]
    [defense]
        hills=40
        mountains=30
    [/defense]
    [resistance]
        blade=90
        pierce=90
        impact=110
    [/resistance]

    [leading_anim]
        start_time=-200
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-lead[1~4].png:75,units/harpies/featherlord/harpy-featherlord.png:50"
        [/frame]
        halo_start_time=-100
        [halo_frame]
            halo="halo/misc/leadership-flare-[1~13].png:20"
            halo_x,halo_y=42,-42
        [/halo_frame]
    [/leading_anim]

    die_sound={SOUND_LIST:HUMAN_FEMALE_DIE}
    [death]
        start_time=0
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-death[1~10].png:[100,50*9]"
        [/frame]
    [/death]

    {DEFENSE_ANIM "units/harpies/featherlord/harpy-featherlord-hit[1~3].png:75" "units/harpies/featherlord/harpy-featherlord.png" {SOUND_LIST:HUMAN_FEMALE_HIT} }

    [standing_anim]
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-idle[1~4].png:200"
        [/frame]
    [/standing_anim]
    [standing_anim]
        start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        submerge=0.01
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-fly[1~4].png:150"
        [/frame]
    [/standing_anim]
    [movement_anim]
        start_time=0
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-fly[1~4].png:150"
        [/frame]
    [/movement_anim]
    [pre_movement_anim]
    start_time=0
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-takeoff[1~4].png:50"
        [/frame]
    [/pre_movement_anim]
    [post_movement_anim]
    start_time=0
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-land[1~2].png:50"
        [/frame]
    [/post_movement_anim]
    [draw_weapon_anim]
    start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-land[1~2].png:50"
        [/frame]
    [/draw_weapon_anim]
    [sheath_weapon_anim]
    start_time=0
        terrain_type={HARPY_UNWALKABLE_TERRAINS}
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-takeoff[1~4].png:50"
        [/frame]
    [/sheath_weapon_anim]
    [idle_anim]
        {STANDARD_IDLE_FILTER}
        terrain_type=!,{HARPY_UNWALKABLE_TERRAINS}
        start_time=0
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-idling[1~5].png:100"
        [/frame]
    [/idle_anim]


    [attack]
        name=lance
        description=_"lance"
        type=pierce
        range=melee
        damage=17
        number=2
        icon=attacks/pike.png
    [/attack]

    [attack]
        name=falcon
        description=_"falcon"
        type=blade
        range=ranged
        damage=6
        number=4
        icon=attacks/claws-animal.png
    [/attack]

    [attack_anim]
        [filter_attack]
            name=lance
        [/filter_attack]
        offset=0.0~0.2,0.2~0.7,0.7~0.2,0.2~0.0
        start_time=-260
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-spear[1~5].png:100"
        [/frame]
        {SOUND:HIT_AND_MISS spear.ogg {SOUND_LIST:MISS} -25}
    [/attack_anim]

    [attack_anim]
        [filter_attack]
            name=falcon
        [/filter_attack]
        start_time=-500
        [frame]
            image="units/harpies/featherlord/harpy-featherlord-hunt[1~9].png:[100*4,70*2,60,100*2]"
        [/frame]
        missile_start_time=-200 
    [if]
        direction=nw,ne,n
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[4,5].png:[150,50],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon1.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/if]
    [else]
        direction=sw,se,s
        [missile_frame]
            halo="units/harpies/flockmaster/harpy-flockmaster-hunt-falcon[1,2,3].png:[100,50*2],units/harpies/flockmaster/harpy-flockmaster-hunt-falcon4.png~FL(horiz):100"
                offset=0.0~1.0,1.0~0.0
        halo_x=20~0:200,0~20:100
        halo_y=-20~0:200,0~-20:100
        auto_vflip=no
            [/missile_frame]        
    [/else]

        {SOUND:HIT_AND_MISS claws.ogg {SOUND_LIST:MISS} -25}
        [frame]
            image="units/harpies/featherlord/harpy-featherlord.png:50"
        [/frame]
    [/attack_anim]
[/unit_type]
